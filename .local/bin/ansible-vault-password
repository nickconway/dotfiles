#!/bin/bash
set -euo pipefail

if [[ ! -e ~/.venvs/venv ]]; then
    mkdir -p $HOME/.venvs
    python3 -m venv $HOME/.venvs/venv
    source $HOME/.venvs/venv/bin/activate
    pip install ansible keyring keyring-pass
    deactivate
    exit 1
else
    source $HOME/.venvs/venv/bin/activate
    vault-keyring-client
    deactivate
    exit 0
fi
